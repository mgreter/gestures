if("undefined"==typeof OCBNET)var OCBNET={};
(function(c){var k={},a=[];OCBNET.Gestures=function(d){this.el=d;this.fingers=0;this.finger={};this.ordered=[];this.handlers={};this.surface=k;this.elements=a;c(d).bind("fingerup",c.proxy(this.fingerUp,this)).bind("fingerdown",c.proxy(this.fingerDown,this)).bind("dragstart",function(){return!1});for(var h=0,b=this.init.length;h<b;h++)this.init[h].apply(this,arguments);a.push(c(d))};(function(d){d.init=[];d.handler={};d.handle=function(a){var b=a.originalEvent;if(!b.data)if(b.data=!0,b=a.type.replace(/^trap/,
""),this.handler[b])this.handler[b].apply(this,arguments);else throw"Gesture cannot handle unknown event",b;};d.fingerDown=function(a){var b=c(a.currentTarget),d=a.finger,b=b.data("gesture"),g=b.handlers;(c.isFunction(g.start)?g.start.call(b,a,d):g.start)&&-1==c.inArray(d.id,b.ordered)&&(b.fingers++,b.cached={},b.ordered.push(d.id),b.finger[d.id]=d,k[d.id]=d,b.start={center:b.getCenter(),rotation:b.getRotation(),distance:b.getDistance()},b.move=c.extend({},b.start))};d.fingersMove=function(d,b){for(var f=
a.length;f--;){var g=[],e=a[f].data("gesture"),n=e.handlers,m;for(m in e.finger)for(var l=d.length;l--;)d[l].id==m&&g.push(d[l]);if(g.length){delete e.cached.center;for(l=g.length;l--;){var k=g[l];e.finger[k.id]=k}e.move={center:e.getCenter(),rotation:e.getRotation(),distance:e.getDistance()};e.center=e.move.center;e.rotation=e.move.rotation;e.distance=e.move.distance;var k=e.move.center.y,p=e.start.center.y,l=Math.abs(e.move.center.x-e.start.center.x),k=Math.abs(k-p);c.isFunction(n.move)&&n.move.call(e,
g,b);c.isFunction(n.swipe)&&("undefined"==typeof e.swipeSector&&20<Math.sqrt(l*l+k*k)&&(l=180*Math.atan2(k,l)/Math.PI,e.swipeSector=parseInt(2*(l/90),10),e.swipeSector=Math.min(e.swipeSector,1)),"undefined"!=typeof e.swipeSector&&n.swipe.call(e,e.swipeSector,g,b));c.isFunction(n.transform)&&n.transform.call(e,g,b)}}};d.fingerUp=function(a){var b=c(a.currentTarget),d=a.finger,b=b.data("gesture"),g=b.handlers,e=c.inArray(d.id,b.ordered);-1!=e&&(c.isFunction(g.stop)&&g.stop.call(b,d,a),b.stop={center:b.getCenter(),
rotation:b.getRotation(),distance:b.getDistance()},b.center=b.stop.center,b.rotation=b.stop.rotation,b.distance=b.stop.distance,delete b.swipeSector,b.fingers--,b.ordered.splice(e,1),delete b.finger[d.id],delete k[d.id])};d.getCenter=function(){if(this.cached.center)return this.cached.center;var a={},b=["page","client","screen"],d=["X","Y"],c;for(c in this.finger)for(var e=this.finger[c],k=b.length;k--;)for(var m=d.length;m--;){var l=b[k]+d[m];a[l]||(a[l]=0);a[l]+=e[l]/this.fingers}a.x=a.screenX;
a.y=a.screenY;return this.cached.center=a};d.getRotation=function(){if(this.cached.rotation)return this.cached.rotation;if(2>this.fingers)return 0;for(var a=0,b=0,d=0,c=0,e=this.ordered.length;c<e;c++)for(var k=this.finger[this.ordered[c]],m=c+1;m<e;m++){d++;var l=this.finger[this.ordered[m]],a=a+(l.screenX-k.screenX),b=b+(l.screenY-k.screenY)}return 180*Math.atan2(b/d,a/d)/Math.PI};d.getDistance=function(){if(this.cached.distance)return this.cached.distance;if(2>this.fingers)return 0;for(var a=0,
b=0,d=0,c=0,e=this.ordered.length;c<e;c++)for(var k=this.finger[this.ordered[c]],m=c+1;m<e;m++){d++;var l=this.finger[this.ordered[m]],a=a+Math.abs(l.screenX-k.screenX),b=b+Math.abs(l.screenY-k.screenY)}a/=d;b/=d;return Math.sqrt(a*a+b*b)}})(OCBNET.Gestures.prototype);c.fn.gesture=function(a){c(this).each(function(h,b){var f=c(b).data("gesture");"undefined"==typeof f&&(f=new OCBNET.Gestures(b),c(b).data("gesture",f));c.extend(f.handlers,a)})}})(jQuery);
(function(){var c={add:function(c){var a=c.handler;c.handler=function(d){var c=a.call(this,d);if(!1==c||d.isPropagationStopped()){var b=d.type,f=d.isTrigger,g=d.isPropagationStopped,e=d.isImmediatePropagationStopped;d.type="trap"+d.type;d.isPropagationStopped=function(){return!1};d.isImmediatePropagationStopped=function(){return!1};jQuery(d.target).trigger(d);d.type=b;d.isTrigger=f;g&&d.stopPropagation();e&&d.stopImmediatePropagation();if("undefined"!=typeof c)return c}}}};jQuery.event.special.mouseup=
c;jQuery.event.special.mouseout=c;jQuery.event.special.mouseover=c;jQuery.event.special.mousemove=c;jQuery.event.special.mousedown=c;jQuery.event.special.touchend=c;jQuery.event.special.touchmove=c;jQuery.event.special.touchstart=c;jQuery.event.special.touchcancel=c})();
(function(c){if(!("ontouchstart"in window)){var k=function(a,c){a.button&&!a.originalEvent.which&&(a.button&1&&!c[1]?a.which=1:a.button&4&&!c[2]?a.which=2:a.button&2&&!c[3]&&(a.which=3))};OCBNET.Gestures.prototype.handler.mouseup=function(a){var d={};d[a.which]=a.data;0>a.clientX||0>a.clientY||a.clientX>c(window).width()||c(window).height();for(var h in d){var b=d[h],f=b.el,g=b.mover,b=b.handler;c(f).data("hand");var e={el:f,id:parseInt(h),type:a.type,pageX:a.pageX,pageY:a.pageY,clientX:a.clientX,
clientY:a.clientY,screenX:a.screenX,screenY:a.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent},e=new c.Event("fingerup",{finger:e});c(f).trigger(e);c(f).unbind("mouseup",b);c(f).unbind("mousemove",g);c(f).unbind("mousewheel",b);c(f).unbind("trapmouseup",b);c(f).unbind("trapmousemove",g);c(f).unbind("trapmousewheel",b);c(document).unbind("mouseup",b);c(document).unbind("mousemove",g);c(document).unbind("mousewheel",b);c(document).unbind("trapmouseup",b);c(document).unbind("trapmousemove",
g);c(document).unbind("trapmousewheel",b)}};OCBNET.Gestures.prototype.handler.mousemove=function(a){var d=a.which,h=a.data.el,b=c(h).data("gesture"),f=[];for(d in b.surface)f.push({el:h,id:d,type:a.type,pageX:a.pageX,pageY:a.pageY,clientX:a.clientX,clientY:a.clientY,screenX:a.screenX,screenY:a.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent});b.fingersMove(f,a)};OCBNET.Gestures.prototype.handler.mousedown=function(a){var d=a.which,h=a.currentTarget,b=c(h).data("gesture");k(a,b.surface);
0!=a.button&&a.preventDefault();var f=function(a){parseInt(d)===parseInt(a.which)&&b.handle.apply(b,arguments)},g=function(a){b.handle.apply(b,arguments)},e={el:h,id:d,handler:f,mover:g};a={el:h,id:a.which,type:a.type,pageX:a.pageX,pageY:a.pageY,clientX:a.clientX,clientY:a.clientY,screenX:a.screenX,screenY:a.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent};var n=new c.Event("fingerdown",{finger:a});-1==c.inArray(a.id,b.ordered)&&(c(h).bind("mouseup",e,f),c(h).bind("mousemove",e,g),c(h).bind("mousewheel",
e,f),c(h).bind("trapmouseup",e,f),c(h).bind("trapmousemove",e,g),c(h).bind("trapmousewheel",e,f),c(document).bind("mouseup",e,f),c(document).bind("mousemove",e,g),c(document).bind("mousewheel",e,f),c(document).bind("trapmouseup",e,f),c(document).bind("trapmousemove",e,g),c(document).bind("trapmousewheel",e,f));c(h).trigger(n)};OCBNET.Gestures.prototype.handler.mousewheel=function(a,d,h,b){d=c(a.data.el).data("gesture");for(var f=d.elements,g=f.length;g--;){d=f[g].data("gesture");var e=d.handlers;
d.fingers&&(d.cached.rotation||(d.cached.rotation=0),d.cached.distance||(d.cached.distance=0),d.cached.rotation+=3*h,d.cached.distance+=5*b,d.move={center:d.getCenter(),rotation:d.getRotation(),distance:d.getDistance()},d.center=d.move.center,d.rotation=d.move.rotation,d.distance=d.move.distance,c.isFunction(e.transform)&&e.transform.call(d,d.finger,a))}};OCBNET.Gestures.prototype.init.push(function(a){c(a).bind("mousedown",c.proxy(this.handle,this))})}})(jQuery);
(function(c){function k(a){var d=a.currentTarget;c(a.originalEvent.changedTouches||[]).each(function(h,b){var f=new c.Event("fingerup",{finger:{id:b.identifier,type:a.type,pageX:b.pageX,pageY:b.pageY,clientX:b.clientX,clientY:b.clientY,screenX:b.screenX,screenY:b.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent}});c(d).trigger(f)})}OCBNET.Gestures.prototype.handler.touchend=k;OCBNET.Gestures.prototype.handler.touchcancel=k;OCBNET.Gestures.prototype.handler.touchstart=function(a){var d=
a.currentTarget;c(a.originalEvent.changedTouches||[]).each(function(h,b){var f=new c.Event("fingerdown",{finger:{el:d,id:b.identifier,type:a.type,pageX:b.pageX,pageY:b.pageY,clientX:b.clientX,clientY:b.clientY,screenX:b.screenX,screenY:b.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent}});c(d).trigger(f)})};OCBNET.Gestures.prototype.handler.touchmove=function(a){var d=a.currentTarget,h=c(d).data("gesture"),b=[];c(a.originalEvent.changedTouches||[]).each(function(c,g){b.push({el:d,id:g.identifier,
type:a.type,pageX:g.pageX,pageY:g.pageY,clientX:g.clientX,clientY:g.clientY,screenX:g.screenX,screenY:g.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent})});h.fingersMove(b,a)};OCBNET.Gestures.prototype.init.push(function(a){c(a).bind("touchend",c.proxy(this.handle,this)).bind("touchmove",c.proxy(this.handle,this)).bind("touchstart",c.proxy(this.handle,this)).bind("touchcancel",c.proxy(this.handle,this)).bind("traptouchend",c.proxy(this.handle,this)).bind("traptouchmove",c.proxy(this.handle,
this)).bind("traptouchstart",c.proxy(this.handle,this)).bind("traptouchcancel",c.proxy(this.handle,this))})})(jQuery);
