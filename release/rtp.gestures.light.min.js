if("undefined"==typeof OCBNET)var OCBNET={};
(function(c){var e={},l=[];OCBNET.Gestures=function(a){this.el=a;this.hands=[];this.maximum=this.fingers=0;this.finger={};this.ordered=[];this.handlers={};this.surface=e;this.elements=l;c(a).bind("fingerup",c.proxy(this.fingerUp,this)).bind("fingerdown",c.proxy(this.fingerDown,this)).bind("dragstart",function(){return!1});for(var m=0,b=this.init.length;m<b;m++)this.init[m].apply(this,arguments);l.push(c(a))};OCBNET.Gestures.Hand=function(){};OCBNET.Gestures.Finger=function(){};(function(a){a.init=
[];a.handler={};a.handle=function(m){var b=m.originalEvent;if(!b.data)if(b.data=!0,b=m.type.replace(/^trap/,""),this.handler[b])this.handler[b].apply(this,arguments);else throw"Gesture cannot handle unknown event",b;};a.fingerDown=function(m){var b=c(m.currentTarget),a=m.finger,b=b.data("gesture"),f=b.handlers;(c.isFunction(f.start)?f.start.call(b,m,a):f.start)&&-1==c.inArray(a.id,b.ordered)&&(b.fingers++,b.maximum<b.fingers&&(b.maximum=b.fingers),b.cached={},b.ordered.push(a.id),b.finger[a.id]=a,
e[a.id]=a,b.start={center:b.getCenter(),rotation:b.getRotation(),distance:b.getDistance()},b.move=c.extend({},b.start))};a.fingersMove=function(a,b){for(var g=l.length;g--;){var f=[],d=l[g].data("gesture"),n=d.handlers,k;for(k in d.finger)for(var h=a.length;h--;)a[h].id==k&&f.push(a[h]);if(f.length){delete d.cached.center;for(h=f.length;h--;){var e=f[h];d.finger[e.id]=e}d.move={center:d.getCenter(),rotation:d.getRotation(),distance:d.getDistance()};d.center=d.move.center;d.rotation=d.move.rotation;
d.distance=d.move.distance;var e=d.move.center.y,p=d.start.center.y,h=Math.abs(d.move.center.x-d.start.center.x),e=Math.abs(e-p);c.isFunction(n.move)&&n.move.call(d,f,b);c.isFunction(n.swipe)&&("undefined"==typeof d.swipeSector&&20<Math.sqrt(h*h+e*e)&&(h=180*Math.atan2(e,h)/Math.PI,d.swipeSector=parseInt(2*(h/90),10),d.swipeSector=Math.min(d.swipeSector,1)),"undefined"!=typeof d.swipeSector&&n.swipe.call(d,d.swipeSector,f,b));c.isFunction(n.transform)&&n.transform.call(d,f,b)}}};a.fingerUp=function(a){var b=
c(a.currentTarget),g=a.finger,b=b.data("gesture"),f=b.handlers,d=c.inArray(g.id,b.ordered);-1!=d&&(c.isFunction(f.stop)&&f.stop.call(b,g,a),b.stop={center:b.getCenter(),rotation:b.getRotation(),distance:b.getDistance()},b.center=b.stop.center,b.rotation=b.stop.rotation,b.distance=b.stop.distance,delete b.swipeSector,b.fingers--,b.ordered.splice(d,1),delete b.finger[g.id],delete e[g.id])};a.getCenter=function(){if(this.cached.center)return this.cached.center;var a={},b=["page","client","screen"],c=
["X","Y"],f;for(f in this.finger)for(var d=this.finger[f],e=b.length;e--;)for(var k=c.length;k--;){var h=b[e]+c[k];a[h]||(a[h]=0);a[h]+=d[h]/this.fingers}a.x=a.screenX;a.y=a.screenY;return this.cached.center=a};a.getRotation=function(){if(this.cached.rotation)return this.cached.rotation;if(2>this.fingers)return 0;for(var a=0,b=0,c=0,f=0,d=this.ordered.length;f<d;f++)for(var e=this.finger[this.ordered[f]],k=f+1;k<d;k++){c++;var h=this.finger[this.ordered[k]],a=a+(h.screenX-e.screenX),b=b+(h.screenY-
e.screenY)}return 180*Math.atan2(b/c,a/c)/Math.PI};a.getDistance=function(){if(this.cached.distance)return this.cached.distance;if(2>this.fingers)return 0;for(var a=0,b=0,c=0,f=0,d=this.ordered.length;f<d;f++)for(var e=this.finger[this.ordered[f]],k=f+1;k<d;k++){c++;var h=this.finger[this.ordered[k]],a=a+Math.abs(h.screenX-e.screenX),b=b+Math.abs(h.screenY-e.screenY)}a/=c;b/=c;return Math.sqrt(a*a+b*b)}})(OCBNET.Gestures.prototype);c.fn.gesture=function(a){c(this).each(function(e,b){var g=c(b).data("gesture");
"undefined"==typeof g&&(g=new OCBNET.Gestures(b),c(b).data("gesture",g));c.extend(g.handlers,a)})}})(jQuery);
(function(){var c={add:function(c){var l=c.handler;c.handler=function(a){var c=l.call(this,a);if(!1==c||a.isPropagationStopped()){var b=a.type,g=a.isTrigger,f=a.isPropagationStopped,d=a.isImmediatePropagationStopped;a.type="trap"+a.type;a.isPropagationStopped=function(){return!1};a.isImmediatePropagationStopped=function(){return!1};jQuery(a.target).trigger(a);a.type=b;a.isTrigger=g;f&&a.stopPropagation();d&&a.stopImmediatePropagation();if("undefined"!=typeof c)return c}}}};jQuery.event.special.mouseup=
c;jQuery.event.special.mouseout=c;jQuery.event.special.mouseover=c;jQuery.event.special.mousemove=c;jQuery.event.special.mousedown=c;jQuery.event.special.touchend=c;jQuery.event.special.touchmove=c;jQuery.event.special.touchstart=c;jQuery.event.special.touchcancel=c})();
(function(c){(function(e){var l=e.handler;l.touchstart=function(a){var e=a.currentTarget;c(a.originalEvent.changedTouches||[]).each(function(b,g){var f=new c.Event("fingerdown",{finger:{el:e,id:g.identifier,type:a.type,screenX:g.screenX,screenY:g.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent}});c(e).trigger(f)})};l.touchend=function(a){var e=a.currentTarget;c(a.originalEvent.changedTouches||[]).each(function(b,g){var f=new c.Event("fingerup",{finger:{id:g.identifier,type:a.type,screenX:g.screenX,
screenY:g.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent}});c(e).trigger(f)})};l.touchmove=function(a){var e=a.currentTarget,b=c(e).data("gesture"),g=[];c(a.originalEvent.changedTouches||[]).each(function(b,c){g.push({el:e,id:c.identifier,type:a.type,screenX:c.screenX,screenY:c.screenY,timeStamp:a.timeStamp,originalEvent:a.originalEvent})});b.fingersMove(g,a)};l.touchcancel=l.touchend;e.init.push(function(a){var e=c.proxy(this.handle,this),b=["start","move","end","cancel"],g;for(g in b){var f=
b[g];c(a).bind("touch"+f,e).bind("traptouch"+f,e)}})})(OCBNET.Gestures.prototype)})(jQuery);
