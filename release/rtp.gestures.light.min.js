if("undefined"==typeof OCBNET)var OCBNET={};
(function(c){var d={},f=[];OCBNET.Gestures=function(b){this.el=b;this.fingers=0;this.finger={};this.ordered=[];this.handlers={};this.surface=d;this.elements=f;c(b).bind("fingerup",c.proxy(this.fingerUp,this)).bind("fingerdown",c.proxy(this.fingerDown,this)).bind("dragstart",function(){return!1});for(var l=0,a=this.init.length;l<a;l++)this.init[l].apply(this,arguments);f.push(c(b))};(function(b){b.init=[];b.handler={};b.handle=function(l){var a=l.originalEvent;if(!a.data)if(a.data=!0,a=l.type.replace(/^trap/,
""),this.handler[a])this.handler[a].apply(this,arguments);else throw"Gesture cannot handle unknown event",a;};b.fingerDown=function(l){var a=c(l.currentTarget),b=l.finger,a=a.data("gesture"),g=a.handlers;(c.isFunction(g.start)?g.start.call(a,l,b):g.start)&&-1==c.inArray(b.id,a.ordered)&&(a.fingers++,a.cached={},a.ordered.push(b.id),a.finger[b.id]=b,d[b.id]=b,a.start={center:a.getCenter(),rotation:a.getRotation(),distance:a.getDistance()},a.move=c.extend({},a.start))};b.fingersMove=function(b,a){for(var k=
f.length;k--;){var g=[],e=f[k].data("gesture"),m=e.handlers,n;for(n in e.finger)for(var h=b.length;h--;)b[h].id==n&&g.push(b[h]);if(g.length){delete e.cached.center;for(h=g.length;h--;){var d=g[h];e.finger[d.id]=d}e.move={center:e.getCenter(),rotation:e.getRotation(),distance:e.getDistance()};e.center=e.move.center;e.rotation=e.move.rotation;e.distance=e.move.distance;var d=e.move.center.y,p=e.start.center.y,h=Math.abs(e.move.center.x-e.start.center.x),d=Math.abs(d-p);c.isFunction(m.move)&&m.move.call(e,
g,a);c.isFunction(m.swipe)&&("undefined"==typeof e.swipeSector&&20<Math.sqrt(h*h+d*d)&&(h=180*Math.atan2(d,h)/Math.PI,e.swipeSector=parseInt(2*(h/90),10),e.swipeSector=Math.min(e.swipeSector,1)),"undefined"!=typeof e.swipeSector&&m.swipe.call(e,e.swipeSector,g,a));c.isFunction(m.transform)&&m.transform.call(e,g,a)}}};b.fingerUp=function(b){var a=c(b.currentTarget),k=b.finger,a=a.data("gesture"),g=a.handlers,e=c.inArray(k.id,a.ordered);-1!=e&&(c.isFunction(g.stop)&&g.stop.call(a,k,b),a.stop={center:a.getCenter(),
rotation:a.getRotation(),distance:a.getDistance()},a.center=a.stop.center,a.rotation=a.stop.rotation,a.distance=a.stop.distance,delete a.swipeSector,a.fingers--,a.ordered.splice(e,1),delete a.finger[k.id],delete d[k.id])};b.getCenter=function(){if(this.cached.center)return this.cached.center;var b={},a=["page","client","screen"],c=["X","Y"],g;for(g in this.finger)for(var e=this.finger[g],f=a.length;f--;)for(var d=c.length;d--;){var h=a[f]+c[d];b[h]||(b[h]=0);b[h]+=e[h]/this.fingers}b.x=b.screenX;
b.y=b.screenY;return this.cached.center=b};b.getRotation=function(){if(this.cached.rotation)return this.cached.rotation;if(2>this.fingers)return 0;for(var b=0,a=0,c=0,g=0,e=this.ordered.length;g<e;g++)for(var f=this.finger[this.ordered[g]],d=g+1;d<e;d++){c++;var h=this.finger[this.ordered[d]],b=b+(h.screenX-f.screenX),a=a+(h.screenY-f.screenY)}return 180*Math.atan2(a/c,b/c)/Math.PI};b.getDistance=function(){if(this.cached.distance)return this.cached.distance;if(2>this.fingers)return 0;for(var b=0,
a=0,c=0,g=0,e=this.ordered.length;g<e;g++)for(var f=this.finger[this.ordered[g]],d=g+1;d<e;d++){c++;var h=this.finger[this.ordered[d]],b=b+Math.abs(h.screenX-f.screenX),a=a+Math.abs(h.screenY-f.screenY)}b/=c;a/=c;return Math.sqrt(b*b+a*a)}})(OCBNET.Gestures.prototype);c.fn.gesture=function(b){c(this).each(function(f,a){var d=c(a).data("gesture");"undefined"==typeof d&&(d=new OCBNET.Gestures(a),c(a).data("gesture",d));c.extend(d.handlers,b)})}})(jQuery);
(function(){var c={add:function(c){var f=c.handler;c.handler=function(b){var c=f.call(this,b);if(!1==c||b.isPropagationStopped()){var a=b.type,d=b.isTrigger,g=b.isPropagationStopped,e=b.isImmediatePropagationStopped;b.type="trap"+b.type;b.isPropagationStopped=function(){return!1};b.isImmediatePropagationStopped=function(){return!1};jQuery(b.target).trigger(b);b.type=a;b.isTrigger=d;g&&b.stopPropagation();e&&b.stopImmediatePropagation();if("undefined"!=typeof c)return c}}}};jQuery.event.special.mouseup=
c;jQuery.event.special.mouseout=c;jQuery.event.special.mouseover=c;jQuery.event.special.mousemove=c;jQuery.event.special.mousedown=c;jQuery.event.special.touchend=c;jQuery.event.special.touchmove=c;jQuery.event.special.touchstart=c;jQuery.event.special.touchcancel=c})();
(function(c){function d(f){var b=f.currentTarget;c(f.originalEvent.changedTouches||[]).each(function(d,a){var k=new c.Event("fingerup",{finger:{id:a.identifier,type:f.type,pageX:a.pageX,pageY:a.pageY,clientX:a.clientX,clientY:a.clientY,screenX:a.screenX,screenY:a.screenY,timeStamp:f.timeStamp,originalEvent:f.originalEvent}});c(b).trigger(k)})}OCBNET.Gestures.prototype.handler.touchend=d;OCBNET.Gestures.prototype.handler.touchcancel=d;OCBNET.Gestures.prototype.handler.touchstart=function(f){var b=
f.currentTarget;c(f.originalEvent.changedTouches||[]).each(function(d,a){var k=new c.Event("fingerdown",{finger:{el:b,id:a.identifier,type:f.type,pageX:a.pageX,pageY:a.pageY,clientX:a.clientX,clientY:a.clientY,screenX:a.screenX,screenY:a.screenY,timeStamp:f.timeStamp,originalEvent:f.originalEvent}});c(b).trigger(k)})};OCBNET.Gestures.prototype.handler.touchmove=function(f){var b=f.currentTarget,d=c(b).data("gesture"),a=[];c(f.originalEvent.changedTouches||[]).each(function(c,d){a.push({el:b,id:d.identifier,
type:f.type,pageX:d.pageX,pageY:d.pageY,clientX:d.clientX,clientY:d.clientY,screenX:d.screenX,screenY:d.screenY,timeStamp:f.timeStamp,originalEvent:f.originalEvent})});d.fingersMove(a,f)};OCBNET.Gestures.prototype.init.push(function(d){c(d).bind("touchend",c.proxy(this.handle,this)).bind("touchmove",c.proxy(this.handle,this)).bind("touchstart",c.proxy(this.handle,this)).bind("touchcancel",c.proxy(this.handle,this)).bind("traptouchend",c.proxy(this.handle,this)).bind("traptouchmove",c.proxy(this.handle,
this)).bind("traptouchstart",c.proxy(this.handle,this)).bind("traptouchcancel",c.proxy(this.handle,this))})})(jQuery);
