if("undefined"==typeof OCBNET)var OCBNET={};
(function(c){var b=[],f=0,g={};OCBNET.Gestures=function(a,e){this.el=a;this.config=c.extend({"native":{},swipeSectors:2,swipeMinDistance:20},e,!0);this.id=f++;b.push(this);this.maximum=this.fingers=0;this.finger={};this.ordered=[];this.surface=g;c(a).bind("dragstart",function(){return!1});for(var d=0,k=this.init.length;d<k;d++)this.init[d].apply(this,arguments)};OCBNET.Gestures.fingerup=function(a){for(var e=b.length;e--;)b[e].fingerUp(a)};OCBNET.Gestures.fingermove=function(a){for(var e=b.length;e--;)b[e].fingerMove(a)};
OCBNET.Gestures.fingersmove=function(a){for(var e=b.length;e--;)for(var d in b[e].finger){var k=c.Event("fingermove",{id:d,x:a.x,y:a.y,originalEvent:a});b[e].fingerMove(k)}};OCBNET.Gestures.fingersup=function(a){for(var e=b.length;e--;)for(var d in b[e].finger){var k=c.Event("fingerup",{id:d,x:a.x,y:a.y,originalEvent:a});b[e].fingerUp(k)}};OCBNET.Gestures.Finger=function(a){this.id=a.id;this.x=a.x;this.y=a.y};(function(a){a.init=[];a.fingerDown=function(e){var d=new OCBNET.Gestures.Finger(e);e=new c.Event("handstart",
{finger:d,gesture:this,originalEvent:e});c(this.el).triggerHandler(e);e.isDefaultPrevented()||this.hasFinger(d.id)||(this.start={center:this.getCenter(),rotation:this.getRotation(),distance:this.getDistance()},this.offset={x:0,y:0},this.center=this.start.center,this.distance=this.rotation=0,this.fingers++,this.maximum<this.fingers&&(this.maximum=this.fingers),this.ordered.push(d.id),this.finger[d.id]=d,g[d.id]=d,this.start={center:this.getCenter(),rotation:this.getRotation(),distance:this.getDistance()},
this.move=c.extend({},this.start))};a.fingerMove=function(e){var d=e.id;if(this.hasFinger(d)){d=this.getFinger(d);d.x=e.x;d.y=e.y;this.move={center:this.getCenter(),rotation:this.getRotation(),distance:this.getDistance()};this.offset={x:this.move.center.x-this.start.center.x,y:this.move.center.y-this.start.center.y};this.center=this.move.center;this.rotation=this.move.rotation-this.start.rotation;this.distance=this.move.distance-this.start.distance;var a=Math.abs(this.offset.x),b=Math.abs(this.offset.y);
c(this.el).triggerHandler(new c.Event("handmove",{finger:d,gesture:this,originalEvent:e}));"undefined"==typeof this.swipeSector&&Math.sqrt(a*a+b*b)>this.config.swipeMinDistance&&(a=180*Math.atan2(b,a)/Math.PI,this.swipeSector=parseInt(a/90*this.config.swipeSectors,10),this.swipeSector=Math.min(this.swipeSector,this.config.swipeSectors-1));"undefined"!=typeof this.swipeSector&&c(this.el).triggerHandler(new c.Event("handswipe",{finger:d,gesture:this,originalEvent:e}));1<this.fingers&&c(this.el).triggerHandler(new c.Event("handtransform",
{finger:d,gesture:this,originalEvent:e}))}};a.fingerUp=function(e){var a=e.id;this.hasFinger(a)&&(a=this.getFinger(a),a.x=e.x,a.y=e.y,this.stop={center:this.getCenter(),rotation:this.getRotation(),distance:this.getDistance()},this.offset={x:this.stop.center.x-this.start.center.x,y:this.stop.center.y-this.start.center.y},this.center=this.stop.center,this.rotation=this.stop.rotation-this.start.rotation,this.distance=this.stop.distance-this.start.distance,e=new c.Event("handstop",{finger:a,gesture:this}),
c(this.el).triggerHandler(e),this.fingers--,delete this.offset,delete this.rotation,delete this.distance,delete this.swipeSector,e=c.inArray(a.id,this.ordered),this.ordered.splice(e,1),delete this.finger[a.id],delete g[a.id])};a.getCenter=function(){var a={x:0,y:0},d;for(d in this.finger){var c=this.finger[d];a.x+=c.x;a.y+=c.y}this.fingers&&(a.x/=this.fingers,a.y/=this.fingers);return a};a.getRotation=function(){if(2>this.fingers)return 0;for(var a=0,d=0,c=0,b=0,f=this.ordered.length;b<f;b++)for(var g=
this.finger[this.ordered[b]],h=b+1;h<f;h++){c++;var l=this.finger[this.ordered[h]],a=a+(l.x-g.x),d=d+(l.y-g.y)}return 180*Math.atan2(d/c,a/c)/Math.PI};a.getDistance=function(){if(2>this.fingers)return 0;for(var a=0,c=0,b=0,f=0,g=this.ordered.length;f<g;f++)for(var m=this.finger[this.ordered[f]],h=f+1;h<g;h++){b++;var l=this.finger[this.ordered[h]],a=a+Math.abs(l.x-m.x),c=c+Math.abs(l.y-m.y)}a/=b;c/=b;return Math.sqrt(a*a+c*c)};a.hasFinger=function(a){return a in this.finger};a.getFinger=function(a){return this.finger[a]}})(OCBNET.Gestures.prototype);
c.fn.gesture=function(a){c(this).each(function(b,d){var f=c(d).data("gesture");if("undefined"==typeof f)f=new OCBNET.Gestures(d,a),c(d).data("gesture",f);else{if(0<f.fingers)throw"fatal: live config change";c.extend(f.config,a,!0)}});return this}})(jQuery);
(function(c){"ontouchstart"in window&&!(window.navigator.msPointerEnabled&&0<window.navigator.msMaxTouchPoints)&&(function(b){b.init.push(function(b){var g=this;c(b).bind("touchstart",function(a){var b=a.originalEvent.changedTouches||[],d=c(a.currentTarget).data("gesture");d!==g&&eval("alert('assertion')");c(b).each(function(b,e){var f=new c.Event("fingerdown",{type:"touch",x:e.screenX,y:e.screenY,id:e.identifier,originalEvent:a});d.fingerDown(f)})});c(b).bind("handswipe",function(a){2==a.gesture.config.swipeSectors&&
(0===a.gesture.swipeSector&&a.gesture.config["native"].panY&&a.preventDefault(),1===a.gesture.swipeSector&&a.gesture.config["native"].panX&&a.preventDefault())})})}(OCBNET.Gestures.prototype),c(document).bind("touchend touchcancel",function(b){c(b.originalEvent.changedTouches||[]).each(function(f,g){var a=c.Event("fingerup",{type:"touch",x:g.screenX,y:g.screenY,id:g.identifier,originalEvent:b});OCBNET.Gestures.fingerup(a)})}),c(document).bind("touchmove",function(b){c(b.originalEvent.changedTouches||
[]).each(function(f,g){var a=c.Event("fingermove",{type:"touch",x:g.screenX,y:g.screenY,id:g.identifier,originalEvent:b});OCBNET.Gestures.fingermove(a)})}))})(jQuery);
(function(c){window.navigator.msPointerEnabled&&0<window.navigator.msMaxTouchPoints&&(function(b){b.init.push(function(b){var g=this;c(b).bind("MSPointerDown",function(a){var b=a.originalEvent,d=c(a.currentTarget).data("gesture");d!==g&&eval("alert('assertion')");a=new c.Event("fingerdown",{type:"pointer",x:b.pageX,y:b.pageY,id:b.pointerId,originalEvent:a});d.fingerDown(a)}).css("msTouchAction","none")})}(OCBNET.Gestures.prototype),c(document).bind("MSPointerUp",function(b){var f=b.originalEvent;
b=new c.Event("fingerup",{type:"pointer",x:f.pageX,y:f.pageY,id:f.pointerId,originalEvent:b});OCBNET.Gestures.fingerup(b)}),c(document).bind("MSPointerMove",function(b){var f=b.originalEvent;b=c.Event("fingermove",{type:"pointer",x:f.pageX,y:f.pageY,id:f.pointerId,originalEvent:b});OCBNET.Gestures.fingermove(b)}))})(jQuery);
